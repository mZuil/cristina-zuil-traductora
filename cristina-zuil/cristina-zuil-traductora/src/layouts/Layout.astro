---
import { ClientRouter } from 'astro:transitions';
import SEOHead from '../features/seo/SEOHead.astro';
import DesignTokens from '../structure/DesignTokens/DesignTokens.astro';
import { i18nConfig } from '../config/i18n.js';
import { getSEOData, getStructuredData } from '../utils/seo.js';

//CSS Styles
import '../styles/global.css';
import GridOverlay from '../structure/GridOverlay/GridOverlay.astro';

interface Props {
  content: any; // Strapi content (page, book, article, etc.)
  locale?: string;
  contentType?: 'WebSite' | 'WebPage' | 'Article' | 'Book' | 'CollectionPage';
  defaultTitle?: string;
  defaultDescription?: string;
  defaultImage?: string;
}

const {
  content,
  locale = i18nConfig.defaultLocale,
  contentType = 'WebPage',
  defaultTitle,
  defaultDescription,
  defaultImage,
} = Astro.props;

// Get SEO data from Strapi content
const seoData = getSEOData(content, locale, Astro, {
  defaultTitle,
  defaultDescription,
  defaultImage,
});

// Get structured data
const structuredData = getStructuredData(content, contentType, locale, Astro);
---

<!DOCTYPE html>
<html lang={locale}>
  <head>
    <DesignTokens />
    <SEOHead seoData={seoData} />
    <ClientRouter />
    <script type="application/ld+json" set:html={JSON.stringify(structuredData, null, 2)} />
  </head>
  <body>
    <slot />

    <GridOverlay />
  </body>
</html>

<script>
  import '../scripts/lenis.js';
</script>