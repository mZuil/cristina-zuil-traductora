---
import { designTokens } from '../../config/design-tokens';

// Generate CSS variables from design tokens
const cssVars: string[] = [];

// Colors
const colors = designTokens.colors as Record<string, string>;
for (const key in colors) {
  if (colors.hasOwnProperty(key)) {
    cssVars.push(`  --color-${key}: ${colors[key]};`);
  }
}

// Breakpoints
const breakpoints = designTokens.breakpoints;
for (const key in breakpoints) {
  if (breakpoints.hasOwnProperty(key)) {
    const value = breakpoints[key as keyof typeof breakpoints];
    cssVars.push(`  --breakpoint-${key}: ${value.breakpoint};`);
    cssVars.push(`  --grid-columns-${key}: ${value.columns};`);
    cssVars.push(`  --grid-gap-${key}: ${value.gap};`);
    cssVars.push(`  --container-padding-${key}: ${value.padding};`);
  }
}

// Container max-width (separate from breakpoints)
cssVars.push(`  --container-max-width: ${designTokens.containerMaxWidth};`);

// Container inner width (default)
cssVars.push(`  --container-inner-width: 100%;`);

// Font families
const fontFamilies = designTokens.fonts.families as Record<string, string>;
for (const key in fontFamilies) {
  if (fontFamilies.hasOwnProperty(key)) {
    cssVars.push(`  --font-family-${key}: ${fontFamilies[key]};`);
  }
}

// Responsive variables for each breakpoint
// sm: < 610px, md: 610px - 1190px, lg: >= 1191px
const { sm, md, lg } = designTokens.breakpoints;
const mdBreakpoint = md.breakpoint; // 610px
const lgBreakpoint = lg.breakpoint; // 1191px

const cssVariables = `:root {
${cssVars.join('\n')}
}

/* Small breakpoint (default, < 610px) */
:root {
  --total-columns: ${sm.columns};
  --grid-gutter: ${sm.gap};
  --container-padding: ${sm.padding};
}

/* Medium breakpoint (610px - 1190px) */
@media (min-width: ${mdBreakpoint}) and (max-width: 1190px) {
  :root {
    --total-columns: ${md.columns};
    --grid-gutter: ${md.gap};
    --container-padding: ${md.padding};
  }
}

/* Large breakpoint (>= 1191px) */
@media (min-width: ${lgBreakpoint}) {
  :root {
    --total-columns: ${lg.columns};
    --grid-gutter: ${lg.gap};
    --container-padding: ${lg.padding};
  }
  
  /* Update container inner width when viewport exceeds max-width */
  :root {
    --container-inner-width: min(100dvw - 2 * var(--container-padding), var(--container-max-width));
  }
}`;
---

<style is:global set:html={cssVariables}></style>
