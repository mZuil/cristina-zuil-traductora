---
import './GridOverlay.css';
import CustomContainer from '../CustomContainer/CustomContainer.astro';
import CustomColumn from '../CustomColumn/CustomColumn.astro';
import { designTokens } from '../../config/design-tokens';

const { sm, md, lg } = designTokens.breakpoints;
---

<div id="grid-overlay" class="grid-overlay hidden">
  <CustomContainer class="grid-debug-container">
    <!-- Create columns for all breakpoints: lg=1 md=1 sm=1 -->
    <!-- On small: shows 4 columns, on medium: 8 columns, on large: 12 columns -->
    {Array.from({ length: lg.columns }, (_, i) => (
      <CustomColumn lg={1} md={1} sm={1} class="grid-debug-column">
        <div class="grid-debug-inner">{i + 1}</div>
      </CustomColumn>
    ))}
  </CustomContainer>
</div>

<script>
  // Grid overlay toggle component with keyboard shortcut
  // Press Cmd+Shift+G (Mac) or Ctrl+Shift+G (Windows) to toggle

  (function() {
    // Wait for DOM to be ready
    function init() {
      let isVisible = false;
      const overlay = document.getElementById('grid-overlay');
      
      if (!overlay) {
        console.warn('GridOverlay: overlay element not found');
        return;
      }

      function toggleGrid() {
        if (!overlay) return;
        
        isVisible = !isVisible;
        overlay.classList.toggle('hidden', !isVisible);
        
        console.log('Grid overlay toggled:', isVisible ? 'ON' : 'OFF');
      }

      // Keyboard shortcut: Cmd+Shift+G (Mac) or Ctrl+Shift+G (Windows)
      document.addEventListener('keydown', (e) => {
        const isMac = navigator.platform.toUpperCase().indexOf('MAC') >= 0 || 
                      navigator.userAgent.toUpperCase().indexOf('MAC') >= 0;
        const modifier = isMac ? e.metaKey : e.ctrlKey;
        
        if (modifier && e.shiftKey && (e.key === 'G' || e.key === 'g')) {
          e.preventDefault();
          e.stopPropagation();
          toggleGrid();
        }
      });
      
      console.log('GridOverlay initialized. Press Ctrl+Shift+G (Windows) or Cmd+Shift+G (Mac) to toggle.');
    }

    // Initialize when DOM is ready
    if (document.readyState === 'loading') {
      document.addEventListener('DOMContentLoaded', init);
    } else {
      init();
    }
  })();
</script>
